"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{3724:function(e,r,n){n.d(r,{E:function(){return M},r:function(){return B}});var t=n(5893),a=n(8527),i=n(6886),o=n(5193),u=n(9762),l=n(7657),c=n(1358),s=n(4612),f=n(1664),d=n.n(f),h=n(5456),m=n(4051),p=n.n(m),b=n(7294),v=n(7536),y=n(1153),x=n(5321),g=n(4480),j=n(3125),w=n(4231),I=n(5496),k=n(7375);function S(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function O(e,r,n,t,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?r(l):Promise.resolve(l).then(t,a)}function C(e){return function(){var r=this,n=arguments;return new Promise((function(t,a){var i=e.apply(r,n);function o(e){O(i,t,a,o,u,"next",e)}function u(e){O(i,t,a,o,u,"throw",e)}o(void 0)}))}}function E(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);o=!0);}catch(l){u=!0,a=l}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return S(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A=w.Ry({name:w.Z_().required("\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")}),P=n(1163),R=n(5246);function U(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function J(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);o=!0);}catch(l){u=!0,a=l}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return U(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function N(e,r,n,t,a,i,o){try{var u=e[i](o),l=u.value}catch(c){return void n(c)}u.done?r(l):Promise.resolve(l).then(t,a)}function _(e){return function(){var r=this,n=arguments;return new Promise((function(t,a){var i=e.apply(r,n);function o(e){N(i,t,a,o,u,"next",e)}function u(e){N(i,t,a,o,u,"throw",e)}o(void 0)}))}}function L(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function Z(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){L(e,r,n[r])}))}return e}function z(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,a,i=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(i.push(t.value),!r||i.length!==r);o=!0);}catch(l){u=!0,a=l}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return X(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var V=w.Ry({title:w.Z_().required("\u65c5\u306e\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),date:w.Z_(),links:w.IX().of(w.Ry().shape({url:w.Z_().required("url\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044").matches(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+)/,{message:"\u5229\u7528\u53ef\u80fd\u306aURL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),label:w.Z_()}))}),q=function(e,r,n){var t=z((0,k.kt)(),2),a=t[0],i=t[1],o=(0,P.useRouter)(),u=o.query.traveliId,l=(0,v.cI)({resolver:(0,I.X)(V),defaultValues:r}),c=l.register,s=l.control,f=l.handleSubmit,d=l.formState.errors,h=function(){var e=(0,b.useState)(),r=e[0],n=e[1],t=J((0,k.kt)(),2),a=t[0],i=t[1];return{uploadImage:function(e){var r=(0,y.cF)(),n=(0,y.iH)(r,encodeURI(e.name));return(0,y.KV)(n,e).then((function(){return(0,y.Jt)(n)}))},image:r,handleChangeImage:function(e){null!==e.target.files&&(n(e.target.files[0]),i.on())},isImageChanged:a}}(),m=h.uploadImage,x=h.image,w=h.handleChangeImage,S=h.isImageChanged,O=(0,g.sJ)(j.y),C=R.h0,E=R.pz,A=(0,v.Dq)({name:"links",control:s}),U=A.fields,X=A.append,N=A.remove,L=function(){var r=_(p().mark((function r(n){var t,a;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(O){r.next=2;break}return r.abrupt("return");case 2:if(t=n,r.prev=3,i.on(),!x||!S){r.next=10;break}return r.next=8,m(x);case 8:a=r.sent,t.thumbnail=a;case 10:"create"===e?q(t,O):D(t,u),r.next=16;break;case 13:r.prev=13,r.t0=r.catch(3),console.error(r.t0);case 16:return r.prev=16,i.off(),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[3,13,16,19]])})));return function(e){return r.apply(this,arguments)}}(),q=function(){var e=_(p().mark((function e(r,t){var a;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C(Z({},r,{ownerIcon:n.icon,ownerName:n.name}),t.uid);case 4:a=e.sent,o.push(window.location.origin+a);case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),D=function(){var e=_(p().mark((function e(r,n){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(r,n);case 2:o.push(window.location.origin+n);case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();return{register:c,handleSubmit:f,fields:U,append:X,remove:N,onSubmit:L,errors:d,disabled:a,handleChangeImage:w,image:x}};function D(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function T(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){D(e,r,n[r])}))}return e}var B=function(){var e=(0,P.useRouter)(),r=function(){var e=(0,v.cI)({resolver:(0,I.X)(A)}),r=e.register,n=e.handleSubmit,t=e.formState.errors,a=(0,g.sJ)(j.y),i=(0,y.cF)(),o=(0,b.useState)(),u=o[0],l=o[1],c=(0,b.useState)(""),s=c[0],f=c[1],d=(0,b.useState)(""),h=d[0],m=d[1],w=(0,b.useState)(!1),S=w[0],O=w[1],P=E((0,k.kt)(),2),R=P[0],U=P[1];(0,b.useEffect)((function(){var e=function(){var e=C(p().mark((function e(){var r,n,t,i,o;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return r=(0,x.ad)(),n=(0,x.hJ)(r,"profiles"),t=(0,x.JU)(n,a.uid),e.next=7,(0,x.QT)(t);case 7:if(i=e.sent,o=i.data()){e.next=11;break}return e.abrupt("return");case 11:return m(o.icon),f(o.name),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var J=function(){var e=C(p().mark((function e(r){var n,t,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(n=(0,x.ad)(),t=(0,x.hJ)(n,"profiles"),i=(0,x.JU)(t,a.uid),""!=r.name||!r.icon){e.next=11;break}return m(r.icon),e.next=9,(0,x.r7)(i,{icon:r.icon});case 9:case 15:case 22:e.next=25;break;case 11:if(!r.name||""!=r.icon){e.next=17;break}return f(r.name),e.next=15,(0,x.r7)(i,{name:r.name});case 17:if(!r.name||!r.icon){e.next=24;break}return m(r.icon),f(r.name),e.next=22,(0,x.pl)(i,{name:r.name,icon:r.icon});case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return{onSubmit:function(e){try{if(U.on(),u){var r=(0,y.iH)(i,encodeURI(u.name));(0,y.KV)(r,u).then((function(){(0,y.Jt)(r).then((function(r){var n={name:e.name,icon:r};J(n)}))}))}else if(!u&&e.name){var n={name:e.name,icon:""};J(n),alert("\u4fdd\u5b58\u3055\u308c\u307e\u3057\u305f")}}catch(t){O(!0)}finally{U.off()}},handleSubmit:n,register:r,handleChangeIcon:function(e){null!==e.target.files&&l(e.target.files[0])},error:S,iconUrl:h,name:s,image:u,errors:t,disabled:R}}(),n=r.onSubmit,f=r.handleSubmit,m=r.register,w=r.handleChangeIcon,S=r.error,O=r.iconUrl,R=r.name,U=r.image,J=r.disabled,X=(0,b.useRef)(null);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(a.xu,{as:"form",height:"100vh",position:"relative",children:[S&&(0,t.jsx)(i.bZ,{children:"\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}),(0,t.jsxs)(a.kC,{w:"100%",h:"6.3rem",justify:"center",align:"center",children:[(0,t.jsx)(d(),{href:e.basePath+"/home",passHref:!0,children:(0,t.jsx)(o.hU,{"aria-label":"return",size:"lg",icon:(0,t.jsx)(h.BK,{w:"2.2rem",h:"2.2rem"})})}),(0,t.jsx)(a.LZ,{}),(0,t.jsx)(a.xu,{color:"black",fontSize:"md",fontWeight:"bold",children:"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb"}),(0,t.jsx)(a.LZ,{}),(0,t.jsx)(a.xu,{w:"2.2rem",h:"2.2rem"})]}),(0,t.jsxs)(u.NI,{children:[(0,t.jsx)(a.kC,{align:"center",justify:"center",children:(0,t.jsx)(a.xu,{borderRadius:"50%",filter:"drop-shadow(4px 4px 10px #E4EBEE);",marginBottom:"2.4rem",bgColor:"base",children:(0,t.jsx)(l.qE,{src:U?URL.createObjectURL(U):O,w:"12.9rem",h:"12.9rem",onClick:function(){var e;null===(e=X.current)||void 0===e||e.click()}})})}),(0,t.jsx)(c.by,{onChange:w,ref:X,id:"icon",type:"file",accept:"image/*"}),(0,t.jsx)(u.lX,{htmlFor:"name",fontSize:"md",children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"}),(0,t.jsx)(a.kC,{align:"center",justify:"center",children:(0,t.jsx)(s.II,T({variant:"filled",w:"34.4rem",h:"4.6rem",borderRightRadius:"10rem",borderLeftRadius:"10rem",bgColor:"white",filter:"drop-shadow(4px 4px 10px #E4EBEE)",id:"name",defaultValue:R},m("name")))})]}),(0,t.jsx)(o.zx,{position:"absolute",bottom:"12.9rem",right:"50%",transform:"translateX(50%)",disabled:J,variant:"round",onClick:f(n),children:"\u6c7a\u5b9a"})]})})},F=n(4651),H=n(4971);function $(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function K(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){$(e,r,n[r])}))}return e}var M=function(e){var r=e.formType,n=e.travelinkData,i=e.ownerProfile,l=e.isOwner,c=q(r,n,i),f=c.register,d=c.handleSubmit,h=c.fields,m=c.append,p=c.remove,b=c.onSubmit,v=c.errors,y=c.disabled,x=c.image,g=c.handleChangeImage;return(0,t.jsxs)(a.xu,{children:[(0,t.jsxs)(u.NI,{isInvalid:!!v.title,children:[(0,t.jsx)(u.lX,{children:"\u65c5\u306e\u540d\u524d"}),(0,t.jsx)(s.II,K({},f("title"),{placeholder:"\u4f8b\uff09\u3068\u3082\u3060\u3061\u3068\u306e\u4e00\u6cca\u4e8c\u65e5\u306e\u65c5\u884c"})),(0,t.jsx)(u.J1,{children:v.title&&v.title.message})]}),(0,t.jsxs)(u.NI,{isInvalid:!!v.date,children:[(0,t.jsx)(u.lX,{children:"\u65e5\u6642\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(s.II,K({placeholder:"2022/01/23 ~ 2022/01/25"},f("date"))),(0,t.jsx)(u.J1,{children:v.date&&v.date.message})]}),(0,t.jsxs)(u.NI,{children:[(0,t.jsx)(u.lX,{children:"\u30b5\u30e0\u30cd\u30a4\u30eb\u753b\u50cf\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(s.II,{type:"file",accept:"image/*",onChange:g}),(0,t.jsx)(F.Ee,{alt:"",src:x?URL.createObjectURL(x):null===n||void 0===n?void 0:n.thumbnail})]}),(0,t.jsxs)(u.NI,{children:[(0,t.jsx)(a.aV,{children:h.map((function(e,r){var n,i,o,l;return(0,t.jsxs)(a.HC,{children:[(0,t.jsxs)(u.NI,{isInvalid:!!v.links,children:[(0,t.jsx)(u.lX,{children:"URL"}),(0,t.jsx)(s.II,K({isInvalid:!!(null===(n=v.links)||void 0===n?void 0:n[r])},f("links.".concat(r,".url")),{defaultValue:e.url})),(0,t.jsx)(u.J1,{children:(null===(i=v.links)||void 0===i?void 0:i[r])&&(null===(l=null===(o=v.links)||void 0===o?void 0:o[r].url)||void 0===l?void 0:l.message)})]}),(0,t.jsx)(u.lX,{children:"\u30e9\u30d9\u30eb"}),(0,t.jsx)(s.II,K({},f("links.".concat(r,".label")),{defaultValue:e.label}))]},e.id)}))}),(0,t.jsx)("button",{type:"button",onClick:function(){m({url:"",label:""})},children:"append"}),(0,t.jsx)("button",{type:"button",onClick:function(){p(1)},children:"remove"}),(l||"create"===r)&&(0,t.jsxs)(u.NI,{display:"flex",alignItems:"center",children:[(0,t.jsx)(u.lX,{children:"\u4ed6\u306e\u30e6\u30fc\u30b6\u306b\u7de8\u96c6\u3092\u8a31\u53ef\u3059\u308b"}),(0,t.jsx)(H.r,K({},f("canEdit"),{defaultChecked:null===n||void 0===n?void 0:n.canEdit}))]}),(0,t.jsx)(o.zx,{disabled:y,onClick:d(b),variant:"solid",children:"\u9001\u4fe1\u3059\u308b"})]})]})}}}]);