"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{8390:function(e,n,r){r.d(n,{v:function(){return _},r:function(){return D}});var t=r(5893),a=r(8527),i=r(9762),o=r(4612),u=r(4651),c=r(4971),l=r(5193),s=r(4051),f=r.n(s),d=r(1163),h=r(7536),m=r(4231),v=r(5496),p=r(7375),b=r(6276),y=r(3125),x=r(4480),j=r(1153),g=r(7294);function I(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function w(e,n,r,t,a,i,o){try{var u=e[i](o),c=u.value}catch(l){return void r(l)}u.done?n(c):Promise.resolve(c).then(t,a)}function k(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function O(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){k(e,n,r[n])}))}return e}function S(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,a,i=[],o=!0,u=!1;try{for(r=r.call(e);!(o=(t=r.next()).done)&&(i.push(t.value),!n||i.length!==n);o=!0);}catch(c){u=!0,a=c}finally{try{o||null==r.return||r.return()}finally{if(u)throw a}}return i}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return I(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=m.Ry({title:m.Z_().required("\u65c5\u306e\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),date:m.Z_(),links:m.IX().of(m.Ry().shape({url:m.Z_().required("url\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044").matches(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+)/,{message:"\u5229\u7528\u53ef\u80fd\u306aURL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),label:m.Z_()}))}),J=function(){var e=S((0,p.kt)(),2),n=e[0],r=e[1],t=(0,d.useRouter)(),a=(0,h.cI)({resolver:(0,v.X)(P),defaultValues:{links:[{url:"",label:""}]}}),i=a.register,o=a.control,u=a.handleSubmit,c=a.formState.errors,l=function(){var e=(0,g.useState)(),n=e[0],r=e[1];return{uploadImage:function(e){var n=(0,j.cF)(),r=(0,j.iH)(n,encodeURI(e.name));return(0,j.KV)(r,e).then((function(){return(0,j.Jt)(r)}))},image:n,handleChangeImage:function(e){null!==e.target.files&&r(e.target.files[0])}}}(),s=l.uploadImage,m=l.image,I=l.handleChangeImage,k=(0,x.sJ)(y.y),J=b.h,C=(0,h.Dq)({name:"links",control:o}),U=C.fields,R=C.append,E=C.remove,X=function(){var e,n=(e=f().mark((function e(n){var a,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:if(a="",e.prev=3,r.on(),!m){e.next=9;break}return e.next=8,s(m);case 8:a=e.sent;case 9:return e.next=11,J(O({},n,{thumbnail:a}),k.uid);case 11:i=e.sent,t.push(t.basePath+i),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error(e.t0);case 18:return e.prev=18,r.off(),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})),function(){var n=this,r=arguments;return new Promise((function(t,a){var i=e.apply(n,r);function o(e){w(i,t,a,o,u,"next",e)}function u(e){w(i,t,a,o,u,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}();return{register:i,handleSubmit:u,fields:U,append:R,remove:E,onSubmit:X,errors:c,disabled:n,handleChangeImage:I,image:m}},C=r(5321);function U(e,n,r,t,a,i,o){try{var u=e[i](o),c=u.value}catch(l){return void r(l)}u.done?n(c):Promise.resolve(c).then(t,a)}function R(e){return function(){var n=this,r=arguments;return new Promise((function(t,a){var i=e.apply(n,r);function o(e){U(i,t,a,o,u,"next",e)}function u(e){U(i,t,a,o,u,"throw",e)}o(void 0)}))}}var E=m.Ry({name:m.Z_().required("\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")});function X(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function N(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){X(e,n,r[n])}))}return e}var _=function(){var e=J(),n=e.register,r=e.handleSubmit,s=e.fields,f=e.append,d=e.remove,h=e.onSubmit,m=e.errors,v=e.disabled,p=e.image,b=e.handleChangeImage;return(0,t.jsxs)(a.xu,{children:[(0,t.jsxs)(i.NI,{isInvalid:!!m.title,children:[(0,t.jsx)(i.lX,{children:"\u65c5\u306e\u540d\u524d"}),(0,t.jsx)(o.II,N({},n("title"),{placeholder:"\u4f8b\uff09\u3068\u3082\u3060\u3061\u3068\u306e\u4e00\u6cca\u4e8c\u65e5\u306e\u65c5\u884c"})),(0,t.jsx)(i.J1,{children:m.title&&m.title.message})]}),(0,t.jsxs)(i.NI,{isInvalid:!!m.date,children:[(0,t.jsx)(i.lX,{children:"\u65e5\u6642\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(o.II,N({placeholder:"2022/01/23 ~ 2022/01/25"},n("date"))),(0,t.jsx)(i.J1,{children:m.date&&m.date.message})]}),(0,t.jsxs)(i.NI,{children:[(0,t.jsx)(i.lX,{children:"\u30b5\u30e0\u30cd\u30a4\u30eb\u753b\u50cf\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(o.II,{type:"file",accept:"image/*",onChange:b}),(0,t.jsx)(u.Ee,{alt:"",src:p?URL.createObjectURL(p):""})]}),(0,t.jsxs)(i.NI,{children:[(0,t.jsx)(a.aV,{children:s.map((function(e,r){var u,c,l,s;return(0,t.jsxs)(a.HC,{children:[(0,t.jsxs)(i.NI,{isInvalid:!!m.links,children:[(0,t.jsx)(i.lX,{children:"URL"}),(0,t.jsx)(o.II,N({isInvalid:!!(null===(u=m.links)||void 0===u?void 0:u[r])},n("links.".concat(r,".url")))),(0,t.jsx)(i.J1,{children:(null===(c=m.links)||void 0===c?void 0:c[r])&&(null===(s=null===(l=m.links)||void 0===l?void 0:l[r].url)||void 0===s?void 0:s.message)})]}),(0,t.jsx)(i.lX,{children:"\u30e9\u30d9\u30eb"}),(0,t.jsx)(o.II,N({},n("links.".concat(r,".label"))))]},e.id)}))}),(0,t.jsx)("button",{type:"button",onClick:function(){f({url:"",label:""})},children:"append"}),(0,t.jsx)("button",{type:"button",onClick:function(){d(1)},children:"remove"}),(0,t.jsxs)(i.NI,{display:"flex",alignItems:"center",children:[(0,t.jsx)(i.lX,{children:"\u4ed6\u306e\u30e6\u30fc\u30b6\u306b\u7de8\u96c6\u3092\u8a31\u53ef\u3059\u308b"}),(0,t.jsx)(c.r,N({},n("canEdit")))]}),(0,t.jsx)(l.zx,{disabled:v,onClick:r(h),variant:"solid",children:"\u9001\u4fe1\u3059\u308b"})]})]})},A=r(6886),Z=r(7657);function q(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function L(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){q(e,n,r[n])}))}return e}var D=function(){var e=function(){var e=(0,h.cI)({resolver:(0,v.X)(E)}),n=e.register,r=e.handleSubmit,t=e.formState.errors,a=(0,x.sJ)(y.y),i=(0,j.cF)(),o=(0,g.useState)(),u=o[0],c=o[1],l=(0,g.useState)(""),s=l[0],d=l[1],m=(0,g.useState)(""),p=m[0],b=m[1],I=(0,g.useState)(!1),w=I[0],k=I[1];(0,g.useEffect)((function(){var e=function(){var e=R(f().mark((function e(){var n,r,t,i,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return n=(0,C.ad)(),r=(0,C.hJ)(n,"profiles"),t=(0,C.JU)(r,a.uid),e.next=7,(0,C.QT)(t);case 7:if(i=e.sent,o=i.data()){e.next=11;break}return e.abrupt("return");case 11:return b(o.icon),d(o.name),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var O=function(){var e=R(f().mark((function e(n){var r,t,i;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:if(r=(0,C.ad)(),t=(0,C.hJ)(r,"profiles"),i=(0,C.JU)(t,a.uid),""!=n.name||!n.icon){e.next=11;break}return b(n.icon),e.next=9,(0,C.r7)(i,{icon:n.icon});case 9:case 15:case 22:e.next=25;break;case 11:if(!n.name||""!=n.icon){e.next=17;break}return d(n.name),e.next=15,(0,C.r7)(i,{name:n.name});case 17:if(!n.name||!n.icon){e.next=24;break}return b(n.icon),d(n.name),e.next=22,(0,C.pl)(i,{name:n.name,icon:n.icon});case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return{onSubmit:function(e){try{if(u){var n=(0,j.iH)(i,encodeURI(u.name));(0,j.KV)(n,u).then((function(){(0,j.Jt)(n).then((function(n){var r={name:e.name,icon:n};O(r)}))}))}else if(!u&&e.name){var r={name:e.name,icon:""};O(r)}}catch(t){k(!0)}},handleSubmit:r,register:n,handleChangeIcon:function(e){null!==e.target.files&&c(e.target.files[0])},error:w,iconUrl:p,name:s,image:u,errors:t}}(),n=e.onSubmit,r=e.handleSubmit,a=e.register,u=e.handleChangeIcon,c=e.error,s=e.iconUrl,d=e.name,m=e.image,p=e.errors;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("form",{onSubmit:r(n),children:[c&&(0,t.jsx)(A.bZ,{children:"\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}),(0,t.jsx)("p",{children:"\u30c6\u30b9\u30c8\u30da\u30fc\u30b8"}),(0,t.jsxs)(i.NI,{isInvalid:!!p.name,children:[(0,t.jsx)(i.lX,{htmlFor:"name",children:"\u540d\u524d"}),(0,t.jsx)(o.II,L({id:"name",defaultValue:d},a("name"))),(0,t.jsx)(i.J1,{children:p.name&&p.name.message})]}),(0,t.jsxs)(i.NI,{children:[(0,t.jsx)(i.lX,{htmlFor:"icon",children:"\u30a2\u30a4\u30b3\u30f3"}),(0,t.jsx)(Z.qE,{src:m?URL.createObjectURL(m):s,w:"6rem",h:"6rem"}),(0,t.jsx)(o.II,{id:"icon",type:"file",accept:"image/*",onChange:u})]}),(0,t.jsx)(l.zx,{type:"submit",children:"Submit"})]})})}},6276:function(e,n,r){r.d(n,{h:function(){return v},n:function(){return f}});var t=r(4051),a=r.n(t),i=r(7294),o=r(5321),u=r(4480),c=r(3125),l=r(1163);function s(e,n,r,t,a,i,o){try{var u=e[i](o),c=u.value}catch(l){return void r(l)}u.done?n(c):Promise.resolve(c).then(t,a)}var f=function(){var e=(0,u.sJ)(c.y),n=(0,i.useState)(),r=n[0],t=n[1],f=(0,l.useRouter)().query.traveliId;return(0,i.useEffect)((function(){if(e&&f){var n=function(){var e,n=(e=a().mark((function e(){var n,r,i,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.ad)(),r=(0,o.JU)((0,o.hJ)(n,"travelinks"),f),e.next=4,(0,o.QT)(r);case 4:if((i=e.sent).exists()){e.next=7;break}return e.abrupt("return");case 7:u=i.data(),t(u);case 9:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,a){var i=e.apply(n,r);function o(e){s(i,t,a,o,u,"next",e)}function u(e){s(i,t,a,o,u,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();n()}}),[]),{travelink:r}};function d(e,n,r,t,a,i,o){try{var u=e[i](o),c=u.value}catch(l){return void r(l)}u.done?n(c):Promise.resolve(c).then(t,a)}function h(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){h(e,n,r[n])}))}return e}var v=function(){var e,n=(e=a().mark((function e(n,r){var t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.ad)(),i=(0,o.JU)((0,o.hJ)(t,"travelinks")),e.next=4,(0,o.pl)(i,m({},n,{id:i.id,ownerId:r,createdAt:(0,o.Bt)(),updatedAt:(0,o.Bt)()}));case 4:return e.abrupt("return",i.id);case 5:case"end":return e.stop()}}),e)})),function(){var n=this,r=arguments;return new Promise((function(t,a){var i=e.apply(n,r);function o(e){d(i,t,a,o,u,"next",e)}function u(e){d(i,t,a,o,u,"throw",e)}o(void 0)}))});return function(e,r){return n.apply(this,arguments)}}()}}]);