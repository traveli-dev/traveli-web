"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{8390:function(e,r,n){n.d(r,{v:function(){return L},r:function(){return K}});var t=n(5893),i=n(8527),a=n(9762),o=n(4612),l=n(4651),u=n(4971),c=n(5193),s=n(4051),f=n.n(s),d=n(1163),h=n(7536),m=n(4231),b=n(5496),p=n(7375),v=n(2772),x=n(3125),y=n(4480),g=n(1153),j=n(7294);function w(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function I(e,r,n,t,i,a,o){try{var l=e[a](o),u=l.value}catch(c){return void n(c)}l.done?r(u):Promise.resolve(u).then(t,i)}function k(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function S(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){k(e,r,n[r])}))}return e}function O(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(a.push(t.value),!r||a.length!==r);o=!0);}catch(u){l=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw i}}return a}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return w(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=m.Ry({title:m.Z_().required("\u65c5\u306e\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),date:m.Z_(),links:m.IX().of(m.Ry().shape({url:m.Z_().required("url\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044").matches(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+)/,{message:"\u5229\u7528\u53ef\u80fd\u306aURL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),label:m.Z_()}))}),E=function(){var e=O((0,p.kt)(),2),r=e[0],n=e[1],t=(0,d.useRouter)(),i=(0,h.cI)({resolver:(0,b.X)(C),defaultValues:{links:[{url:"",label:""}]}}),a=i.register,o=i.control,l=i.handleSubmit,u=i.formState.errors,c=function(){var e=(0,j.useState)(),r=e[0],n=e[1];return{uploadImage:function(e){var r=(0,g.cF)(),n=(0,g.iH)(r,encodeURI(e.name));return(0,g.KV)(n,e).then((function(){return(0,g.Jt)(n)}))},image:r,handleChangeImage:function(e){null!==e.target.files&&n(e.target.files[0])}}}(),s=c.uploadImage,m=c.image,w=c.handleChangeImage,k=(0,y.sJ)(x.y),E=(0,v.mw)(null===k||void 0===k?void 0:k.uid).ownerProfile,P=v.h0,R=(0,h.Dq)({name:"links",control:o}),U=R.fields,A=R.append,J=R.remove,X=function(){var e,r=(e=f().mark((function e(r){var i,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k){e.next=2;break}return e.abrupt("return");case 2:if(E){e.next=4;break}return e.abrupt("return");case 4:if(i="",e.prev=5,n.on(),!m){e.next=11;break}return e.next=10,s(m);case 10:i=e.sent;case 11:return e.next=13,P(S({},r,{thumbnail:i,ownerIcon:null===E||void 0===E?void 0:E.icon,ownerName:null===E||void 0===E?void 0:E.name}),k.uid);case 13:a=e.sent,t.push(t.basePath+a),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),console.error(e.t0);case 20:return e.prev=20,n.off(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[5,17,20,23]])})),function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function o(e){I(a,t,i,o,l,"next",e)}function l(e){I(a,t,i,o,l,"throw",e)}o(void 0)}))});return function(e){return r.apply(this,arguments)}}();return{register:a,handleSubmit:l,fields:U,append:A,remove:J,onSubmit:X,errors:u,disabled:r,handleChangeImage:w,image:m}},P=n(5321);function R(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function U(e,r,n,t,i,a,o){try{var l=e[a](o),u=l.value}catch(c){return void n(c)}l.done?r(u):Promise.resolve(u).then(t,i)}function A(e){return function(){var r=this,n=arguments;return new Promise((function(t,i){var a=e.apply(r,n);function o(e){U(a,t,i,o,l,"next",e)}function l(e){U(a,t,i,o,l,"throw",e)}o(void 0)}))}}function J(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(t=n.next()).done)&&(a.push(t.value),!r||a.length!==r);o=!0);}catch(u){l=!0,i=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw i}}return a}}(e,r)||function(e,r){if(!e)return;if("string"===typeof e)return R(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var X=m.Ry({name:m.Z_().required("\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")});function N(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function _(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){N(e,r,n[r])}))}return e}var L=function(){var e=E(),r=e.register,n=e.handleSubmit,s=e.fields,f=e.append,d=e.remove,h=e.onSubmit,m=e.errors,b=e.disabled,p=e.image,v=e.handleChangeImage;return(0,t.jsxs)(i.xu,{children:[(0,t.jsxs)(a.NI,{isInvalid:!!m.title,children:[(0,t.jsx)(a.lX,{children:"\u65c5\u306e\u540d\u524d"}),(0,t.jsx)(o.II,_({},r("title"),{placeholder:"\u4f8b\uff09\u3068\u3082\u3060\u3061\u3068\u306e\u4e00\u6cca\u4e8c\u65e5\u306e\u65c5\u884c"})),(0,t.jsx)(a.J1,{children:m.title&&m.title.message})]}),(0,t.jsxs)(a.NI,{isInvalid:!!m.date,children:[(0,t.jsx)(a.lX,{children:"\u65e5\u6642\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(o.II,_({placeholder:"2022/01/23 ~ 2022/01/25"},r("date"))),(0,t.jsx)(a.J1,{children:m.date&&m.date.message})]}),(0,t.jsxs)(a.NI,{children:[(0,t.jsx)(a.lX,{children:"\u30b5\u30e0\u30cd\u30a4\u30eb\u753b\u50cf\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(o.II,{type:"file",accept:"image/*",onChange:v}),(0,t.jsx)(l.Ee,{alt:"",src:p?URL.createObjectURL(p):""})]}),(0,t.jsxs)(a.NI,{children:[(0,t.jsx)(i.aV,{children:s.map((function(e,n){var l,u,c,s;return(0,t.jsxs)(i.HC,{children:[(0,t.jsxs)(a.NI,{isInvalid:!!m.links,children:[(0,t.jsx)(a.lX,{children:"URL"}),(0,t.jsx)(o.II,_({isInvalid:!!(null===(l=m.links)||void 0===l?void 0:l[n])},r("links.".concat(n,".url")))),(0,t.jsx)(a.J1,{children:(null===(u=m.links)||void 0===u?void 0:u[n])&&(null===(s=null===(c=m.links)||void 0===c?void 0:c[n].url)||void 0===s?void 0:s.message)})]}),(0,t.jsx)(a.lX,{children:"\u30e9\u30d9\u30eb"}),(0,t.jsx)(o.II,_({},r("links.".concat(n,".label"))))]},e.id)}))}),(0,t.jsx)("button",{type:"button",onClick:function(){f({url:"",label:""})},children:"append"}),(0,t.jsx)("button",{type:"button",onClick:function(){d(1)},children:"remove"}),(0,t.jsxs)(a.NI,{display:"flex",alignItems:"center",children:[(0,t.jsx)(a.lX,{children:"\u4ed6\u306e\u30e6\u30fc\u30b6\u306b\u7de8\u96c6\u3092\u8a31\u53ef\u3059\u308b"}),(0,t.jsx)(u.r,_({},r("canEdit")))]}),(0,t.jsx)(c.zx,{disabled:b,onClick:n(h),variant:"solid",children:"\u9001\u4fe1\u3059\u308b"})]})]})},Z=n(6886),z=n(7657),q=n(1358),V=n(1664),B=n.n(V),D=n(5456);function F(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function H(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{},t=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),t.forEach((function(r){F(e,r,n[r])}))}return e}var K=function(){var e=(0,d.useRouter)(),r=function(){var e=(0,h.cI)({resolver:(0,b.X)(X)}),r=e.register,n=e.handleSubmit,t=e.formState.errors,i=(0,y.sJ)(x.y),a=(0,g.cF)(),o=(0,j.useState)(),l=o[0],u=o[1],c=(0,j.useState)(""),s=c[0],d=c[1],m=(0,j.useState)(""),v=m[0],w=m[1],I=(0,j.useState)(!1),k=I[0],S=I[1],O=J((0,p.kt)(),2),C=O[0],E=O[1];(0,j.useEffect)((function(){var e=function(){var e=A(f().mark((function e(){var r,n,t,a,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return r=(0,P.ad)(),n=(0,P.hJ)(r,"profiles"),t=(0,P.JU)(n,i.uid),e.next=7,(0,P.QT)(t);case 7:if(a=e.sent,o=a.data()){e.next=11;break}return e.abrupt("return");case 11:return w(o.icon),d(o.name),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var R=function(){var e=A(f().mark((function e(r){var n,t,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:if(n=(0,P.ad)(),t=(0,P.hJ)(n,"profiles"),a=(0,P.JU)(t,i.uid),""!=r.name||!r.icon){e.next=11;break}return w(r.icon),e.next=9,(0,P.r7)(a,{icon:r.icon});case 9:case 15:case 22:e.next=25;break;case 11:if(!r.name||""!=r.icon){e.next=17;break}return d(r.name),e.next=15,(0,P.r7)(a,{name:r.name});case 17:if(!r.name||!r.icon){e.next=24;break}return w(r.icon),d(r.name),e.next=22,(0,P.pl)(a,{name:r.name,icon:r.icon});case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return{onSubmit:function(e){try{if(E.on(),l){var r=(0,g.iH)(a,encodeURI(l.name));(0,g.KV)(r,l).then((function(){(0,g.Jt)(r).then((function(r){var n={name:e.name,icon:r};R(n)}))}))}else if(!l&&e.name){var n={name:e.name,icon:""};R(n),alert("\u4fdd\u5b58\u3055\u308c\u307e\u3057\u305f")}}catch(t){S(!0)}finally{E.off()}},handleSubmit:n,register:r,handleChangeIcon:function(e){null!==e.target.files&&u(e.target.files[0])},error:k,iconUrl:v,name:s,image:l,errors:t,disabled:C}}(),n=r.onSubmit,l=r.handleSubmit,u=r.register,s=r.handleChangeIcon,m=r.error,v=r.iconUrl,w=r.name,I=r.image,k=r.disabled,S=(0,j.useRef)(null);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(i.xu,{as:"form",height:"100vh",position:"relative",children:[m&&(0,t.jsx)(Z.bZ,{children:"\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}),(0,t.jsxs)(i.kC,{w:"100%",h:"6.3rem",justify:"center",align:"center",children:[(0,t.jsx)(B(),{href:e.basePath+"/home",passHref:!0,children:(0,t.jsx)(c.hU,{"aria-label":"return",size:"lg",icon:(0,t.jsx)(D.BK,{w:"2.2rem",h:"2.2rem"})})}),(0,t.jsx)(i.LZ,{}),(0,t.jsx)(i.xu,{color:"black",fontSize:"md",fontWeight:"bold",children:"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb"}),(0,t.jsx)(i.LZ,{}),(0,t.jsx)(i.xu,{w:"2.2rem",h:"2.2rem"})]}),(0,t.jsxs)(a.NI,{children:[(0,t.jsx)(i.kC,{align:"center",justify:"center",children:(0,t.jsx)(i.xu,{borderRadius:"50%",filter:"drop-shadow(4px 4px 10px #E4EBEE);",marginBottom:"2.4rem",bgColor:"base",children:(0,t.jsx)(z.qE,{src:I?URL.createObjectURL(I):v,w:"12.9rem",h:"12.9rem",onClick:function(){var e;null===(e=S.current)||void 0===e||e.click()}})})}),(0,t.jsx)(q.by,{onChange:s,ref:S,id:"icon",type:"file",accept:"image/*"}),(0,t.jsx)(a.lX,{htmlFor:"name",fontSize:"md",children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"}),(0,t.jsx)(i.kC,{align:"center",justify:"center",children:(0,t.jsx)(o.II,H({variant:"filled",w:"34.4rem",h:"4.6rem",borderRightRadius:"10rem",borderLeftRadius:"10rem",bgColor:"white",filter:"drop-shadow(4px 4px 10px #E4EBEE)",id:"name",defaultValue:w},u("name")))})]}),(0,t.jsx)(c.zx,{position:"absolute",bottom:"12.9rem",right:"50%",transform:"translateX(50%)",disabled:k,variant:"round",onClick:l(n),children:"\u6c7a\u5b9a"})]})})}}}]);