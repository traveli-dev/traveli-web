"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[390],{8390:function(e,n,r){r.d(n,{v:function(){return _},r:function(){return F}});var t=r(5893),i=r(8527),a=r(9762),o=r(4612),u=r(4651),l=r(4971),c=r(5193),s=r(4051),f=r.n(s),d=r(1163),h=r(7536),m=r(4231),b=r(5496),p=r(7375),v=r(2772),x=r(3125),j=r(4480),g=r(1153),y=r(7294);function I(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function k(e,n,r,t,i,a,o){try{var u=e[a](o),l=u.value}catch(c){return void r(c)}u.done?n(l):Promise.resolve(l).then(t,i)}function w(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){w(e,n,r[n])}))}return e}function O(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,i,a=[],o=!0,u=!1;try{for(r=r.call(e);!(o=(t=r.next()).done)&&(a.push(t.value),!n||a.length!==n);o=!0);}catch(l){u=!0,i=l}finally{try{o||null==r.return||r.return()}finally{if(u)throw i}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return I(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=m.Ry({title:m.Z_().required("\u65c5\u306e\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"),date:m.Z_(),links:m.IX().of(m.Ry().shape({url:m.Z_().required("url\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044").matches(/^(https?|ftp)(:\/\/[-_.!~*'()a-zA-Z0-9;/?:@&=+$,%#]+)/,{message:"\u5229\u7528\u53ef\u80fd\u306aURL\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),label:m.Z_()}))}),P=function(){var e=O((0,p.kt)(),2),n=e[0],r=e[1],t=(0,d.useRouter)(),i=(0,h.cI)({resolver:(0,b.X)(C),defaultValues:{links:[{url:"",label:""}]}}),a=i.register,o=i.control,u=i.handleSubmit,l=i.formState.errors,c=function(){var e=(0,y.useState)(),n=e[0],r=e[1];return{uploadImage:function(e){var n=(0,g.cF)(),r=(0,g.iH)(n,encodeURI(e.name));return(0,g.KV)(r,e).then((function(){return(0,g.Jt)(r)}))},image:n,handleChangeImage:function(e){null!==e.target.files&&r(e.target.files[0])}}}(),s=c.uploadImage,m=c.image,I=c.handleChangeImage,w=(0,j.sJ)(x.y),P=(0,v.mw)(null===w||void 0===w?void 0:w.uid).ownerProfile,E=v.h0,R=(0,h.Dq)({name:"links",control:o}),U=R.fields,J=R.append,X=R.remove,N=function(){var e,n=(e=f().mark((function e(n){var i,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w){e.next=2;break}return e.abrupt("return");case 2:if(P){e.next=4;break}return e.abrupt("return");case 4:if(i="",e.prev=5,r.on(),!m){e.next=11;break}return e.next=10,s(m);case 10:i=e.sent;case 11:return e.next=13,E(S({},n,{thumbnail:i,ownerIcon:null===P||void 0===P?void 0:P.icon,ownerName:null===P||void 0===P?void 0:P.name}),w.uid);case 13:a=e.sent,t.push(t.basePath+a),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),console.error(e.t0);case 20:return e.prev=20,r.off(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[5,17,20,23]])})),function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function o(e){k(a,t,i,o,u,"next",e)}function u(e){k(a,t,i,o,u,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}();return{register:a,handleSubmit:u,fields:U,append:J,remove:X,onSubmit:N,errors:l,disabled:n,handleChangeImage:I,image:m}},E=r(5321);function R(e,n,r,t,i,a,o){try{var u=e[a](o),l=u.value}catch(c){return void r(c)}u.done?n(l):Promise.resolve(l).then(t,i)}function U(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function o(e){R(a,t,i,o,u,"next",e)}function u(e){R(a,t,i,o,u,"throw",e)}o(void 0)}))}}var J=m.Ry({name:m.Z_().required("\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044")});function X(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function N(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){X(e,n,r[n])}))}return e}var _=function(){var e=P(),n=e.register,r=e.handleSubmit,s=e.fields,f=e.append,d=e.remove,h=e.onSubmit,m=e.errors,b=e.disabled,p=e.image,v=e.handleChangeImage;return(0,t.jsxs)(i.xu,{children:[(0,t.jsxs)(a.NI,{isInvalid:!!m.title,children:[(0,t.jsx)(a.lX,{children:"\u65c5\u306e\u540d\u524d"}),(0,t.jsx)(o.II,N({},n("title"),{placeholder:"\u4f8b\uff09\u3068\u3082\u3060\u3061\u3068\u306e\u4e00\u6cca\u4e8c\u65e5\u306e\u65c5\u884c"})),(0,t.jsx)(a.J1,{children:m.title&&m.title.message})]}),(0,t.jsxs)(a.NI,{isInvalid:!!m.date,children:[(0,t.jsx)(a.lX,{children:"\u65e5\u6642\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(o.II,N({placeholder:"2022/01/23 ~ 2022/01/25"},n("date"))),(0,t.jsx)(a.J1,{children:m.date&&m.date.message})]}),(0,t.jsxs)(a.NI,{children:[(0,t.jsx)(a.lX,{children:"\u30b5\u30e0\u30cd\u30a4\u30eb\u753b\u50cf\uff08\u4efb\u610f\uff09"}),(0,t.jsx)(o.II,{type:"file",accept:"image/*",onChange:v}),(0,t.jsx)(u.Ee,{alt:"",src:p?URL.createObjectURL(p):""})]}),(0,t.jsxs)(a.NI,{children:[(0,t.jsx)(i.aV,{children:s.map((function(e,r){var u,l,c,s;return(0,t.jsxs)(i.HC,{children:[(0,t.jsxs)(a.NI,{isInvalid:!!m.links,children:[(0,t.jsx)(a.lX,{children:"URL"}),(0,t.jsx)(o.II,N({isInvalid:!!(null===(u=m.links)||void 0===u?void 0:u[r])},n("links.".concat(r,".url")))),(0,t.jsx)(a.J1,{children:(null===(l=m.links)||void 0===l?void 0:l[r])&&(null===(s=null===(c=m.links)||void 0===c?void 0:c[r].url)||void 0===s?void 0:s.message)})]}),(0,t.jsx)(a.lX,{children:"\u30e9\u30d9\u30eb"}),(0,t.jsx)(o.II,N({},n("links.".concat(r,".label"))))]},e.id)}))}),(0,t.jsx)("button",{type:"button",onClick:function(){f({url:"",label:""})},children:"append"}),(0,t.jsx)("button",{type:"button",onClick:function(){d(1)},children:"remove"}),(0,t.jsxs)(a.NI,{display:"flex",alignItems:"center",children:[(0,t.jsx)(a.lX,{children:"\u4ed6\u306e\u30e6\u30fc\u30b6\u306b\u7de8\u96c6\u3092\u8a31\u53ef\u3059\u308b"}),(0,t.jsx)(l.r,N({},n("canEdit")))]}),(0,t.jsx)(c.zx,{disabled:b,onClick:r(h),variant:"solid",children:"\u9001\u4fe1\u3059\u308b"})]})]})},L=r(6886),Z=r(7657),A=r(1358),z=r(1664),q=r.n(z),V=r(5456);function B(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function D(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){B(e,n,r[n])}))}return e}var F=function(){var e=(0,d.useRouter)(),n=function(){var e=(0,h.cI)({resolver:(0,b.X)(J)}),n=e.register,r=e.handleSubmit,t=e.formState.errors,i=(0,j.sJ)(x.y),a=(0,g.cF)(),o=(0,y.useState)(),u=o[0],l=o[1],c=(0,y.useState)(""),s=c[0],d=c[1],m=(0,y.useState)(""),p=m[0],v=m[1],I=(0,y.useState)(!1),k=I[0],w=I[1];(0,y.useEffect)((function(){var e=function(){var e=U(f().mark((function e(){var n,r,t,a,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return n=(0,E.ad)(),r=(0,E.hJ)(n,"profiles"),t=(0,E.JU)(r,i.uid),e.next=7,(0,E.QT)(t);case 7:if(a=e.sent,o=a.data()){e.next=11;break}return e.abrupt("return");case 11:return v(o.icon),d(o.name),e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]);var S=function(){var e=U(f().mark((function e(n){var r,t,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:if(r=(0,E.ad)(),t=(0,E.hJ)(r,"profiles"),a=(0,E.JU)(t,i.uid),""!=n.name||!n.icon){e.next=11;break}return v(n.icon),e.next=9,(0,E.r7)(a,{icon:n.icon});case 9:case 15:case 22:e.next=25;break;case 11:if(!n.name||""!=n.icon){e.next=17;break}return d(n.name),e.next=15,(0,E.r7)(a,{name:n.name});case 17:if(!n.name||!n.icon){e.next=24;break}return v(n.icon),d(n.name),e.next=22,(0,E.pl)(a,{name:n.name,icon:n.icon});case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return{onSubmit:function(e){try{if(u){var n=(0,g.iH)(a,encodeURI(u.name));(0,g.KV)(n,u).then((function(){(0,g.Jt)(n).then((function(n){var r={name:e.name,icon:n};S(r)}))}))}else if(!u&&e.name){var r={name:e.name,icon:""};S(r),alert("\u4fdd\u5b58\u3055\u308c\u307e\u3057\u305f")}}catch(t){w(!0)}},handleSubmit:r,register:n,handleChangeIcon:function(e){null!==e.target.files&&l(e.target.files[0])},error:k,iconUrl:p,name:s,image:u,errors:t}}(),r=n.onSubmit,u=n.handleSubmit,l=n.register,s=n.handleChangeIcon,m=n.error,p=n.iconUrl,v=n.name,I=n.image,k=(0,y.useRef)(null);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(i.xu,{as:"form",height:"100vh",onSubmit:u(r),position:"relative",children:[m&&(0,t.jsx)(L.bZ,{children:"\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}),(0,t.jsxs)(i.kC,{w:"100%",h:"6.3rem",justify:"center",align:"center",children:[(0,t.jsx)(q(),{href:e.basePath+"/home",passHref:!0,children:(0,t.jsx)(c.hU,{"aria-label":"return",size:"lg",icon:(0,t.jsx)(V.BK,{w:"2.2rem",h:"2.2rem"})})}),(0,t.jsx)(i.LZ,{}),(0,t.jsx)(i.xu,{color:"black",fontSize:"md",fontWeight:"bold",children:"\u30d7\u30ed\u30d5\u30a3\u30fc\u30eb"}),(0,t.jsx)(i.LZ,{}),(0,t.jsx)(i.xu,{w:"2.2rem",h:"2.2rem"})]}),(0,t.jsxs)(a.NI,{children:[(0,t.jsx)(i.kC,{align:"center",justify:"center",children:(0,t.jsx)(i.xu,{borderRadius:"50%",filter:"drop-shadow(4px 4px 10px #E4EBEE);",marginBottom:"2.4rem",bgColor:"base",children:(0,t.jsx)(Z.qE,{src:I?URL.createObjectURL(I):p,w:"12.9rem",h:"12.9rem",as:"button",onClick:function(){var e;null===(e=k.current)||void 0===e||e.click()}})})}),(0,t.jsx)(A.by,{onChange:s,ref:k,id:"icon",type:"file",accept:"image/*"}),(0,t.jsx)(a.lX,{htmlFor:"name",fontSize:"md",children:"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"}),(0,t.jsx)(i.kC,{align:"center",justify:"center",children:(0,t.jsx)(o.II,D({variant:"filled",w:"34.4rem",h:"4.6rem",borderRightRadius:"10rem",borderLeftRadius:"10rem",bgColor:"white",filter:"drop-shadow(4px 4px 10px #E4EBEE)",id:"name",defaultValue:v},l("name")))})]}),(0,t.jsx)(c.zx,{position:"absolute",bottom:"12.9rem",right:"50%",transform:"translateX(50%)",type:"submit",variant:"round",children:"\u6c7a\u5b9a"})]})})}}}]);